C:\Users\1\AppData\Local\Programs\Python\Python39\python.exe C:\Users\1\IdeaProjects\Compartmental-GP-NeurIPS-2020\seir-loop.py
C:\Users\1\IdeaProjects\Compartmental-GP-NeurIPS-2020\data_loader.py:253: FutureWarning: In a future version of pandas all arguments of DataFrame.pivot will be keyword-only.
  dat_feat = country_feat.pivot('country', 'metric', 'value')
running with seed 3
('United Kingdom', 102.61008312831633, 1315.2459347579934)
('Italy', 491.8378926692886, 5961.339875527786)
('Germany', 58.89682130556499, 734.6566255267161)
('Spain', 84.2711259561841, 1036.8263329024999)
('US', 615.0946070534135, -5132.559252084495)
('France', 17.042375594095727, 173.0506159750795)
('Belgium', 96.32236546573245, 1184.697133478587)
('Korea, South', 5.434786881373328, 68.50963717384539)
('Brazil', 914.29601332379, -11424.102823014684)
('Iran', 16.747283397258364, 176.54093936433583)
('Netherlands', 51.83753558024941, 656.9975189754267)
('Canada', 76.93024194016911, 946.0272469363883)
('Turkey', 75.06317774899004, 948.2811121319767)
('Romania', 10.294462519066533, 133.11137437770486)
('Portugal', 16.125120943119246, 197.13267000366162)
('Sweden', 29.748741512353543, 365.47107801221466)
('Switzerland', 31.116518312607088, 391.11410283028516)
('Ireland', 14.392101129416687, 183.17043133468695)
('Hungary', 13.173046302869132, 169.99780852145074)
('Denmark', 10.933309299554416, 140.34520073313638)
('Austria', 14.373313125037855, 183.90558130187145)
('Mexico', 442.7088615766871, 5498.146632815904)
('India', 2981.181251074887, 38392.40723661997)
('Ecuador', 53.556462755731346, 683.8171227606808)
('Russia', 84.54767452991513, 986.562078454383)
('Peru', 463.5534269727752, 5423.927415520982)
('Indonesia', 16.05762038447608, 216.12818635661222)
('Poland', 4.4681267265963625, -56.57922000460752)
('Philippines', 46.10786623456342, 562.0945021555194)
('Japan', 12.40604816899971, 159.29506452342488)
('Pakistan', 795.5832232091109, 10024.03152386382)
running with seed 4
C:\Users\1\AppData\Local\Programs\Python\Python39\lib\site-packages\pyro\optim\dct_adam.py:132: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at  ..\torch\csrc\utils\python_arg_parser.cpp:882.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
step    0 loss = 3.79922e+08
step  100 loss = 320100
step  200 loss = 65902.6
step  300 loss = 135273
step  400 loss = 56410.1
step  500 loss = 22660.2
step  600 loss = 32096.1
step  700 loss = 18091.8
step  800 loss = 20853.8
step  900 loss = 17314.5
step 1000 loss = 24538.4
step 1100 loss = 13323.6
step 1200 loss = 15024.2
step 1300 loss = 12371
step 1400 loss = 20109.8
step 1500 loss = 13284.7
step 1600 loss = 10123.5
step 1700 loss = 24048.8
step 1800 loss = 9932.56
step 1900 loss = 9263.85
('United Kingdom', 70.60103360806616, 918.264528822292)
('Italy', 203.21349422968106, 2450.023485332233)
('Germany', 63.616966525430605, 790.996797570784)
('Spain', 147.14084195071146, 1826.1501982148407)
('US', 726.7889157897077, -6826.1498708230065)
('France', 181.4412487748727, 2315.2540707977396)
('Belgium', 98.0845079399746, 1209.5639932484112)
('Korea, South', 4.0418095828973994, 49.56166841574162)
('Brazil', 787.4955638569058, -9803.901991329887)
('Iran', 86.15922875741076, -1016.4819909858343)
('Netherlands', 63.685120076687255, 803.0152159227208)
('Canada', 60.8814490305108, 724.525443496221)
('Turkey', 72.60305908665144, 915.5310397411552)
('Romania', 2.84479423628901, 35.84152426897316)
('Portugal', 12.738727435401891, 155.34729771434903)
('Sweden', 38.361526780777744, 486.66881646523245)
('Switzerland', 28.240098169358582, 352.53503632780604)
('Ireland', 16.307409923259534, 206.7672398774542)
('Hungary', 8.793279261930879, 111.95368116801735)
('Denmark', 11.442794806374422, 144.14375996334428)
('Austria', 12.503300403415714, 158.48129646912906)
('Mexico', 340.06141247018996, -4036.6551064414016)
('India', 1975.0988416423772, 24435.29251744761)
('Ecuador', 14.934792557114738, 183.48569479680282)
('Russia', 57.792275932844454, -665.9413695485541)
('Peru', 121.13124065232213, 1286.268120570072)
('Indonesia', 13.55105147373541, 180.58279692803274)
('Poland', 2.262100299726427, -25.4433719015031)
('Philippines', 19.26263907684405, 188.55556040182904)
('Japan', 6.038155911398354, 75.75962538210304)
('Pakistan', 392.3445971927657, 4837.6444255468)
running with seed 5
step    0 loss = 1.1508e+06
step  100 loss = 176615
step  200 loss = 158338
step  300 loss = 72443.1
step  400 loss = 65024.6
step  500 loss = 60381.9
step  600 loss = 40503.1
step  700 loss = 33105.4
step  800 loss = 48961.8
step  900 loss = 33750.3
step 1000 loss = 16344.5
step 1100 loss = 27273.6
step 1200 loss = 42882.9
step 1300 loss = 10356.7
step 1400 loss = 12501.2
step 1500 loss = 11487.3
step 1600 loss = 8699.23
step 1700 loss = 8310.31
step 1800 loss = 8286.18
step 1900 loss = 10964.8
('United Kingdom', 56.85988488419876, 759.3128009190841)
('Italy', 179.166924210385, 2153.790997143981)
('Germany', 74.6914736685441, 935.8874024575606)
('Spain', 167.58101105801947, 2093.894455870199)
('US', 252.01676356490458, 1783.5299230076562)
('France', 267.9559196981346, 3423.4290340065445)
('Belgium', 75.66360482291502, 910.9463204169772)
('Korea, South', 5.728037767744054, 73.12912753027581)
('Brazil', 495.7177508160731, -6171.6711001896765)
('Iran', 77.09209240784914, -911.3387465196483)
('Netherlands', 81.93405873459807, 1040.5152183073428)
('Canada', 72.03054333801222, 868.4041535520848)
('Turkey', 82.51869338671646, 1035.6361130173007)
('Romania', 21.97158631828198, 278.2247731196315)
('Portugal', 20.338680042075374, 247.95826745493665)
('Sweden', 26.51815579886554, 333.2869142709907)
('Switzerland', 30.750528319452943, 383.8476933280494)
('Ireland', 18.038418219547204, 229.63280666387794)
('Hungary', 12.412051985193148, 159.94983340865718)
('Denmark', 9.686767247638207, 119.9268463429882)
('Austria', 11.969752791463074, 150.76972167022564)
('Mexico', 171.17657324610047, -2121.9031293557127)
('India', 258.0614584541417, -3298.2596901610614)
('Ecuador', 8.222566465560641, -100.09644267366139)
('Russia', 26.319248183260903, -318.68860536175316)
('Peru', 72.38086768216267, 677.8026629292617)
('Indonesia', 49.19343189419213, -620.4809777073773)
('Poland', 2.0281467922550225, 26.320568465798203)
('Philippines', 17.304301114619786, 103.50414497618209)
('Japan', 7.493016827491478, 92.55648725380617)
('Pakistan', 155.3387063916597, 1917.2141365220398)
running with seed 6
C:\Users\1\AppData\Local\Programs\Python\Python39\lib\site-packages\pyro\infer\trace_elbo.py:138: UserWarning: Encountered NaN: loss
  warn_if_nan(loss, "loss")
step    0 loss = nan
running with seed 7
step    0 loss = 503886
step  100 loss = 203594
step  200 loss = 147903
step  300 loss = 138544
step  400 loss = 105529
step  500 loss = 116596
step  600 loss = 72079.7
step  700 loss = 53973.2
step  800 loss = 68699.4
step  900 loss = 33998.6
step 1000 loss = 35511.9
step 1100 loss = 20605.7
step 1200 loss = 16757.9
step 1300 loss = 21076.8
step 1400 loss = 18690.2
step 1500 loss = 23434.8
step 1600 loss = 33579.3
step 1700 loss = 14027.9
step 1800 loss = 18434.5
step 1900 loss = 15099.2
('United Kingdom', 53.35562615684193, -582.3082808521649)
('Italy', 300.9417701442191, 3624.8790177700507)
('Germany', 46.969542344867584, 585.7023393841599)
('Spain', 184.20882573571774, 2296.4337321688713)
('US', 1408.4708305778997, 18751.697379083533)
('France', 243.7331749807749, 3150.8486024488693)
('Belgium', 37.57334475246269, 457.9285403783336)
('Korea, South', 2.4653856134636247, 29.66385559160446)
('Brazil', 1573.2457130079465, 18829.206463556588)
('Iran', 128.08505971434383, -1586.5986330500791)
('Netherlands', 63.16920449152798, 795.3416423884563)
('Canada', 30.549716584408827, 342.40639996685996)
('Turkey', 68.25686214338103, 860.628108586224)
('Romania', 3.360831201431766, 43.72569805568793)
('Portugal', 14.333771182352862, 174.46837586155132)
('Sweden', 36.958153868596206, 448.3804251944199)
('Switzerland', 12.58031501953114, 156.1872762357855)
('Ireland', 17.22842856940929, 218.01867120103583)
('Hungary', 5.6182608801076075, 72.2356561341572)
('Denmark', 8.993806960165152, 111.35880748816669)
('Austria', 8.329817279111666, 103.75650110136333)
('Mexico', 304.1948661681949, -3741.6443262121247)
('India', 2486.377915227934, 31734.878378387388)
('Ecuador', 51.575325998014385, 669.292957562177)
('Russia', 69.04829205963053, 820.982827158608)
('Peru', 186.51913983100954, 2035.2099011111131)
('Indonesia', 6.301061421168089, 64.17168528463242)
('Poland', 11.359843207414364, -145.5664800365874)
('Philippines', 29.987726791702336, 334.74769368215453)
('Japan', 15.857466536306738, 204.82395077428444)
('Pakistan', 323.4565755587224, 4068.994854551177)
running with seed 8
step    0 loss = 5.74408e+08
step  100 loss = 115045
step  200 loss = 67482
step  300 loss = 58311.1
step  400 loss = 56083.4
step  500 loss = 63576
step  600 loss = 32737.9
step  700 loss = 400180
step  800 loss = 56545.3
step  900 loss = 39128.8
step 1000 loss = 14959.2
step 1100 loss = 28615.1
step 1200 loss = 25932.2
step 1300 loss = 16604.6
step 1400 loss = 26799.9
step 1500 loss = 16063.4
step 1600 loss = 15602.6
step 1700 loss = 12089.3
step 1800 loss = 11981.7
step 1900 loss = 10250.8
('United Kingdom', 14.151321770234565, 192.90803420818702)
('Italy', 91.85333354886508, 1063.1505042879658)
('Germany', 65.9138814870764, 815.2125810551296)
('Spain', 169.0701799091289, 2085.376881498473)
('US', 408.0907598054989, 5564.539652947729)
('France', 359.7647024164449, 4590.851267846551)
('Belgium', 59.92103650687323, 731.0240211090616)
('Korea, South', 4.874338696009449, 61.835781841702186)
('Brazil', 1122.3825899613878, 13497.892873874564)
('Iran', 57.81070825931588, -663.9843743795891)
('Netherlands', 54.30930990077576, 676.0956836874078)
('Canada', 77.68648012096152, 937.5198676331931)
('Turkey', 51.55146012336638, 650.4636740722337)
('Romania', 6.514053939052838, 84.92840397095887)
('Portugal', 18.195025898509346, 223.50629939586602)
('Sweden', 36.46083804940308, 449.4838478674793)
('Switzerland', 25.379667924697465, 316.01055775587616)
('Ireland', 15.58519820671006, 197.42540874253592)
('Hungary', 5.434546137085149, 68.20145992260571)
('Denmark', 11.29056461901543, 141.63353675565304)
('Austria', 11.231648640433137, 142.69335448847806)
('Mexico', 56.32415058500431, 655.7302533122602)
('India', 1496.605535510599, 18541.729513810184)
('Ecuador', 68.06370694641281, 862.3177381084233)
('Russia', 7.136361254042773, 79.9167279478529)
('Peru', 301.89844651816594, 3527.133544105287)
('Indonesia', 21.910615221842214, 288.08073237775136)
('Poland', 2.3919573110700236, -22.012224300648143)
('Philippines', 37.4791584554054, 467.9753343349474)
('Japan', 2.1538958096304857, 14.711897004215889)
('Pakistan', 389.8329362973723, 4863.130851576133)
running with seed 9
step    0 loss = 1.45129e+10
step  100 loss = 78941.7
step  200 loss = 59376.9
step  300 loss = 177238
step  400 loss = 52376.4
step  500 loss = 91192.6
step  600 loss = 32381
step  700 loss = 29162
step  800 loss = 19612.5
step  900 loss = 20892
step 1000 loss = 57345.5
step 1100 loss = 14643.7
step 1200 loss = 22130.3
step 1300 loss = 50625.8
step 1400 loss = 14162.9
step 1500 loss = 10940.7
step 1600 loss = 15289.4
step 1700 loss = 22412.7
step 1800 loss = 23074.1
step 1900 loss = 32287.2
('United Kingdom', 9.70131423540989, 95.69512069328266)
('Italy', 66.11246052364706, 742.8479297878117)
('Germany', 61.212097770876106, 753.4752559025891)
('Spain', 108.49854309215424, 1326.0768702561986)
('US', 509.0965869409801, 6987.223693244632)
('France', 29.51279814657404, -360.0752786037855)
('Belgium', 68.80829442005216, 843.6813440422904)
('Korea, South', 4.441155572205016, 54.68521889361287)
('Brazil', 81.0852554593597, -464.62821467905815)
('Iran', 194.82148462176772, -2376.952463437574)
('Netherlands', 11.049820115390713, 135.08331620222492)
('Canada', 228.31141530442264, 2743.0965892684985)
('Turkey', 38.37531363949165, 479.71861254134575)
('Romania', 0.7374328577961705, 5.159057640559524)
('Portugal', 8.39977622428518, 100.17177090077806)
('Sweden', 7.84129826654399, 83.00108488088799)
('Switzerland', 19.95069704462139, 249.84811129198275)
('Ireland', 5.39479853073557, 67.48160477226675)
('Hungary', 7.688232639852413, 98.96971474330032)
('Denmark', 6.986952168185947, 85.85270028608124)
('Austria', 8.638163792229037, 108.07459570696786)
('Mexico', 1455.5243040410853, 17940.23736218279)
('India', 720.4482168973565, -9386.990253870117)
('Ecuador', 16.913126696875114, -162.24329195702285)
('Russia', 100.47101099295604, -1176.6489566399746)
('Peru', 2206.0721991177024, 26427.57160574168)
('Indonesia', 14.202692449635357, 189.01182704297696)
('Poland', 1.0511144431694852, 13.023078565677622)
('Philippines', 32.196154441875166, 403.79682503266355)
('Japan', 6.067891348762004, 76.00377446974888)
('Pakistan', 2472.7201384180157, 30585.876924402215)
running with seed 10
step    0 loss = 4.57661e+06
step  100 loss = 277511
step  200 loss = 231342
step  300 loss = 124651
step  400 loss = 84417.8
step  500 loss = 102713
step  600 loss = 372306
step  700 loss = 3.88242e+06
step  800 loss = 30167.1
step  900 loss = 63504.6
step 1000 loss = 1.08835e+06
step 1100 loss = 30549
step 1200 loss = 35412.2
step 1300 loss = 44232.1
step 1400 loss = 26088.8
step 1500 loss = 89427.8
step 1600 loss = 29995.9
step 1700 loss = 31474.8
step 1800 loss = 45342.3
step 1900 loss = 25998.3
('United Kingdom', 132.45381020290225, -1575.6385497298434)
('Italy', 60.310772106249864, 639.7006488560843)
('Germany', 117.46266399824243, 1438.3968752356702)
('Spain', 287.24384455236094, 3451.85913079389)
('US', 1981.4789256881973, -22286.99558851016)
('France', 490.1265565077325, -6285.17727893834)
('Belgium', 133.3073295755344, 1642.9405268941875)
('Korea, South', 8.316925230630709, 106.52045163459485)
('Brazil', 1116.3588233013982, -13796.685698965004)
('Iran', 143.10509366105774, -1689.4728264953274)
('Netherlands', 36.47008929764633, 450.64673659734166)
('Canada', 54.50312052095534, -721.9096260319509)
('Turkey', 52.27962293273497, 655.2938924018229)
('Romania', 0.7630216733807929, 4.466976615371834)
('Portugal', 13.781381106622261, 166.91561724938813)
('Sweden', 23.722916400953796, 285.1295667163405)
('Switzerland', 30.66817954209773, 385.8577913850218)
('Ireland', 11.740252862359245, 147.91783265671762)
('Hungary', 8.713453257430249, 112.26574076267731)
('Denmark', 9.00021803828657, 112.62679125217807)
('Austria', 8.638818562336068, 108.50779819803996)
('Mexico', 458.90525045346953, -5485.644512066367)
('India', 4369.728720286207, 54665.98401437714)
('Ecuador', 23.749921538847985, -306.6670617593104)
('Russia', 29.502351151857475, -343.07689075419376)
('Peru', 103.00289389152023, 1087.4108031335454)
('Indonesia', 26.97714747069997, -321.45973798529064)
('Poland', 2.0088054278968865, -24.38444705280125)
('Philippines', 16.747427600888837, 147.5192762551722)
('Japan', 3.434044464997375, 38.21637053649199)
('Pakistan', 651.6904503212085, 8248.94589326294)
running with seed 11
step    0 loss = 2.51415e+07
step  100 loss = 262420
step  200 loss = 196329
step  300 loss = 83725
step  400 loss = 58565.2
step  500 loss = 46243.5
step  600 loss = 66386.5
step  700 loss = 155568
step  800 loss = 55864.6
step  900 loss = 47595.2
step 1000 loss = 148499
step 1100 loss = 22576.2
step 1200 loss = 25402.8
step 1300 loss = 30070
step 1400 loss = 193125
step 1500 loss = 16992.7
step 1600 loss = 69035
step 1700 loss = 113871
step 1800 loss = 21149
step 1900 loss = 115504
('United Kingdom', 23.746385286813695, 325.86614615353756)
('Italy', 114.20805432408706, 1334.0430511243435)
('Germany', 54.92600882740053, 676.179138876072)
('Spain', 66.85653220616827, 800.7202421322642)
('US', 596.2872121541683, -4639.71349055328)
('France', 122.51399993372165, -1594.793919051298)
('Belgium', 83.8813129695637, 1015.9468541288763)
('Korea, South', 3.3156099917331097, 40.44422406187101)
('Brazil', 1287.8897910482126, -16064.695013859782)
('Iran', 178.83107759723288, -2186.053653096111)
('Netherlands', 49.2053842467237, 615.6364013127794)
('Canada', 42.98158553685503, 450.49986905321776)
('Turkey', 49.70502622177576, 624.540313412175)
('Romania', 2.878066030098452, -33.85153083489109)
('Portugal', 12.816068965715967, 155.61391140103015)
('Sweden', 19.74191913018052, 236.63261209176298)
('Switzerland', 24.083881830085, 301.1551614889883)
('Ireland', 13.755643281646897, 173.93232156786365)
('Hungary', 9.799991548641342, 126.39476438779168)
('Denmark', 9.886270451657813, 126.14254476691076)
('Austria', 11.32803934081844, 143.5883737951578)
('Mexico', 28.437880300985658, 330.3836849707259)
('India', 2343.150627805462, 30189.200446193783)
('Ecuador', 17.33596127861352, 195.01716640683844)
('Russia', 179.82177739157115, 2091.8686876011902)
('Peru', 268.3010792072414, 3041.1972377239836)
('Indonesia', 7.074102825489286, -55.41838091322427)
('Poland', 7.429562314072107, -92.10484940969462)
('Philippines', 15.552758566932548, 125.46446485615485)
('Japan', 3.7022908789973776, 45.13595909217811)
('Pakistan', 503.7885756902262, 6079.011917215294)
Traceback (most recent call last):
  File "C:\Users\1\IdeaProjects\Compartmental-GP-NeurIPS-2020\seir-loop.py", line 126, in <module>
    R0low, R0mid, R0high, map_estimates = model.get_R0(forecaster, Y_train, covariates_full_notime, n_sample, 50)
  File "C:\Users\1\IdeaProjects\Compartmental-GP-NeurIPS-2020\pyro_model\seir_gp.py", line 221, in get_R0
    var = pyro_model.helper.tensor_RBF(kernel_lengthscale, kernel_var, covariates_pyro)
  File "C:\Users\1\IdeaProjects\Compartmental-GP-NeurIPS-2020\pyro_model\helper.py", line 32, in tensor_RBF
    r2 = torch.exp(-0.5 * tensor_scaled_dist(l, x))
  File "C:\Users\1\IdeaProjects\Compartmental-GP-NeurIPS-2020\pyro_model\helper.py", line 26, in tensor_scaled_dist
    r2 = x2 - 2 * xz + x2.transpose(-1, -2)
RuntimeError: [enforce fail at ..\c10\core\CPUAllocator.cpp:73] data. DefaultCPUAllocator: not enough memory: you tried to allocate 6793116800 bytes. Buy new RAM!

Process finished with exit code 1
