C:\Users\kg15\AppData\Local\Programs\Python\Python39\python.exe C:/Users/kg15/IdeaProjects/Compartmental-GP-NeurIPS-2020/seir-loop.py
C:\Users\kg15\IdeaProjects\Compartmental-GP-NeurIPS-2020\data_loader.py:255: FutureWarning: In a future version of pandas all arguments of DataFrame.pivot will be keyword-only.
  dat_feat = country_feat.pivot('country', 'metric', 'value')
running with seed 0
step    0 loss = 3.8347e+07
C:\Users\kg15\AppData\Local\Programs\Python\Python39\lib\site-packages\pyro\optim\dct_adam.py:132: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at  ..\torch\csrc\utils\python_arg_parser.cpp:882.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
step  100 loss = 191624
step  200 loss = 184974
step  300 loss = 154673
step  400 loss = 123499
step  500 loss = 182064
step  600 loss = 89085.9
step  700 loss = 90986.2
step  800 loss = 131026
step  900 loss = 53459.3
step 1000 loss = 61423.7
step 1100 loss = 30094.4
step 1200 loss = 207650
step 1300 loss = 25385.6
step 1400 loss = 19667.3
step 1500 loss = 13522.2
step 1600 loss = 14959.9
step 1700 loss = 14335.2
step 1800 loss = 13913.1
step 1900 loss = 11212.1
('United Kingdom', 49.30760330882062, 651.1511783346541)
('Italy', 99.44436635547031, 1158.60050966085)
('Germany', 68.31397359095446, 850.256778920262)
('Spain', 97.95462941418776, 1225.9887630356575)
('US', 505.1099130878189, 6803.837970469729)
('France', 201.89375300169564, 2570.4009747460595)
('Belgium', 84.66141318761954, 1030.2770485423537)
('Korea, South', 4.044941521121812, 51.111495138059496)
('Brazil', 774.2911191349945, -9544.676556512553)
('Iran', 78.2214421409075, -891.0923930876097)
('Netherlands', 57.52926910757616, 728.0161391268101)
('Canada', 70.52278614006127, 864.5415838143565)
('Turkey', 69.79275564406574, 880.9025891216854)
('Romania', 2.8640006422164666, 36.468047671518605)
('Portugal', 13.405163820101569, 161.5367135900324)
('Sweden', 53.33827439657054, 655.3640816869776)
('Switzerland', 20.761910775273286, 261.4703165775557)
('Ireland', 21.365765727328068, 271.5978535988825)
('Hungary', 8.500308197414574, 108.8166052649055)
('Denmark', 10.305935290598175, 129.23731712575307)
('Austria', 9.31854469008836, 117.04409015723691)
('Mexico', 36.32471687671861, 286.3112243571668)
('India', 3407.0768733933337, 40265.1025525428)
('Ecuador', 19.403942656067496, 242.8846161219285)
('Russia', 38.05070464500441, -362.26347761482293)
('Peru', 178.26876405750608, -2287.6713117296604)
('Indonesia', 8.595852933775921, -12.954407245176412)
('Poland', 3.434797210582552, -37.635455522191535)
('Philippines', 17.008127626538133, 6.6897979259779845)
('Japan', 6.330122392877237, 79.97060617775351)
('Pakistan', 279.49752440359896, 3492.307107369358)
running with seed 1
step    0 loss = 851020
step  100 loss = 181128
step  200 loss = 324901
step  300 loss = 144852
step  400 loss = 114950
step  500 loss = 99625.9
step  600 loss = 88249.7
step  700 loss = 74809
step  800 loss = 56292
step  900 loss = 177372
step 1000 loss = 50000.8
step 1100 loss = 41942.6
step 1200 loss = 31255.3
step 1300 loss = 108404
step 1400 loss = 34001.2
step 1500 loss = 25533.3
step 1600 loss = 24302.1
step 1700 loss = 21560.9
step 1800 loss = 14815.5
step 1900 loss = 65119.9
('United Kingdom', 105.95896633417718, -1238.5176865347566)
('Italy', 198.12480637409027, 2395.735652589429)
('Germany', 84.88069334445439, 1054.3233506220784)
('Spain', 226.06822274900168, 2809.2870555932154)
('US', 587.1242532410424, -4046.6583748736084)
('France', 118.06457018130646, 1517.419536791288)
('Belgium', 71.98715459449821, 877.7479981351928)
('Korea, South', 5.442331423284989, 70.20016769633878)
('Brazil', 1582.0625013108893, -19685.295921340577)
('Iran', 186.5777852225706, -2265.598866569927)
('Netherlands', 110.34317177792867, 1395.1162222139537)
('Canada', 13.67023933750932, -185.84148285408054)
('Turkey', 45.60313554562336, 567.1717518917601)
('Romania', 16.965187064579315, 218.55466626561298)
('Portugal', 16.83705292038031, 204.4057961334867)
('Sweden', 115.48621165747394, 1418.487106391578)
('Switzerland', 43.84698971386559, 542.8718829564787)
('Ireland', 26.647250452478396, 340.1018309085321)
('Hungary', 10.524464186746421, 135.90434502978405)
('Denmark', 16.101935392455104, 207.20872370998478)
('Austria', 16.773333907259897, 212.99986195655185)
('Mexico', 233.14727691641147, -2621.114631667322)
('India', 901.983838608503, 10897.653464498873)
('Ecuador', 32.737810034371606, -344.18946253662534)
('Russia', 86.91317651389052, -1026.6876535418992)
('Peru', 176.18939449071547, -2280.1126195838624)
('Indonesia', 37.895589819286634, -460.9000313509936)
('Poland', 8.004820452031579, -103.55763498028381)
('Philippines', 14.268644815385242, -101.94956712622553)
('Japan', 1.387063836368079, 12.808725269315705)
('Pakistan', 379.88864417397014, 4717.848336943042)
running with seed 2
C:\Users\kg15\AppData\Local\Programs\Python\Python39\lib\site-packages\pyro\infer\trace_elbo.py:138: UserWarning: Encountered NaN: loss
  warn_if_nan(loss, "loss")
step    0 loss = nan
running with seed 3
step    0 loss = 1.74217e+08
step  100 loss = 175784
step  200 loss = 140488
step  300 loss = 162746
step  400 loss = 86302.5
step  500 loss = 73594.2
step  600 loss = 37476.1
step  700 loss = 56666.4
step  800 loss = 25246.1
step  900 loss = 57425.8
step 1000 loss = 17166.9
step 1100 loss = 18768.6
step 1200 loss = 16843.7
step 1300 loss = 18458.4
step 1400 loss = 13600
step 1500 loss = 12269.1
step 1600 loss = 16924.6
step 1700 loss = 11514.1
step 1800 loss = 13649.9
step 1900 loss = 17875
('United Kingdom', 103.3589579417478, 1328.091497177098)
('Italy', 558.5289407328787, 6793.275461142305)
('Germany', 104.81280497279081, 1306.9669090279792)
('Spain', 209.1995543507901, 2600.3196237666475)
('US', 359.2585472298196, 4594.658524626604)
('France', 215.45363230106642, 2722.233838446552)
('Belgium', 136.90375029841653, 1697.8298290192618)
('Korea, South', 5.057511265430556, 63.81071874466787)
('Brazil', 651.6685267310932, -8152.7137021157905)
('Iran', 16.98830385334602, -6.38176927335644)
('Netherlands', 78.11027161745166, 989.8211978077801)
('Canada', 97.50729598570366, 1228.8002838856012)
('Turkey', 70.18438473247042, 883.9757794634613)
('Romania', 15.323485585642603, 196.63063682918113)
('Portugal', 18.48944959158197, 226.85162788025642)
('Sweden', 71.55719502805182, 881.6403687407975)
('Switzerland', 38.732380403357425, 483.32818494847635)
('Ireland', 14.599587788497077, 185.97623553460602)
('Hungary', 11.43799362888056, 147.7909726627817)
('Denmark', 13.869047857435486, 178.33574625116069)
('Austria', 15.228455508515074, 194.66043698966746)
('Mexico', 526.0815313310926, 6565.263650667635)
('India', 364.0813023307924, 4201.654618734179)
('Ecuador', 67.57613683871112, 859.3714531151049)
('Russia', 32.14978300211948, 390.30136666543103)
('Peru', 304.92063220925394, 3487.226515603481)
('Indonesia', 22.89855480537233, -256.43570377152685)
('Poland', 4.196967301586123, -52.670720859328014)
('Philippines', 21.461814952980692, 194.10298644444214)
('Japan', 6.3454238533318295, 77.67856865269648)
('Pakistan', 309.5984875674873, 3827.0367485727193)
running with seed 4
step    0 loss = 2.06751e+08
step  100 loss = 158137
step  200 loss = 54291.5
step  300 loss = 150465
step  400 loss = 38660.7
step  500 loss = 22461.3
step  600 loss = 36919.1
step  700 loss = 19928.9
step  800 loss = 22898.4
step  900 loss = 19297.6
step 1000 loss = 23648.2
step 1100 loss = 12740.4
step 1200 loss = 14946.6
step 1300 loss = 13220.9
step 1400 loss = 17556.4
step 1500 loss = 13644.7
step 1600 loss = 9482.08
step 1700 loss = 24074.4
step 1800 loss = 11977.2
step 1900 loss = 10265.6
('United Kingdom', 37.21341732913876, 501.6434518827664)
('Italy', 173.80858590004257, 2098.949756402188)
('Germany', 67.4781523238214, 839.0378197097006)
('Spain', 180.43077321045976, 2255.178198017766)
('US', 638.9188830762852, -5743.687745664276)
('France', 285.98906494488995, 3677.8395430190185)
('Belgium', 93.01699377480493, 1151.5910119418706)
('Korea, South', 4.171577063005026, 51.16981853786149)
('Brazil', 620.9319804707261, -7820.0839224822375)
('Iran', 144.6114778644094, -1764.5448138813126)
('Netherlands', 71.94320660675199, 909.7841803680843)
('Canada', 79.24446578585136, 970.2787614610927)
('Turkey', 47.06863428221876, 592.7342085383373)
('Romania', 14.095110878713045, 183.65415813112946)
('Portugal', 15.230050900555609, 187.02710794822454)
('Sweden', 55.07459951392497, 697.6269683909933)
('Switzerland', 35.27034827457446, 441.5754948060939)
('Ireland', 18.07411869619478, 229.73693185176404)
('Hungary', 8.132204373040803, 103.78908164304313)
('Denmark', 10.574487340266046, 133.330823133808)
('Austria', 11.271554119026218, 142.24041214804703)
('Mexico', 218.15837839264356, 2812.4783186848254)
('India', 2617.800245667768, 32351.384791728284)
('Ecuador', 9.100530648014274, 74.77211770124313)
('Russia', 122.12095871588734, -1443.8549977353846)
('Peru', 66.04714213885791, -896.0873415571368)
('Indonesia', 26.516675632568663, 349.54610708517873)
('Poland', 2.83393982952293, -32.57837596260532)
('Philippines', 16.615313604121802, 138.48613053018738)
('Japan', 4.225698094542849, 50.16381605835018)
('Pakistan', 332.36139812568825, 4095.921367936625)
running with seed 5
step    0 loss = 1.47062e+06
step  100 loss = 156947
step  200 loss = 163400
step  300 loss = 67551.2
step  400 loss = 50784.2
step  500 loss = 60280.1
step  600 loss = 39495.1
step  700 loss = 31623
step  800 loss = 26829
step  900 loss = 30385.7
step 1000 loss = 17209.3
step 1100 loss = 28219.8
step 1200 loss = 28789.3
step 1300 loss = 11817.1
step 1400 loss = 14801.7
step 1500 loss = 10338.9
step 1600 loss = 8715.81
step 1700 loss = 8674.35
step 1800 loss = 7177.36
step 1900 loss = 9839.33
('United Kingdom', 34.0956197727672, 465.3355056696928)
('Italy', 84.89507295339037, 988.7319436331896)
('Germany', 64.81673439741141, 812.7654663328411)
('Spain', 112.4344676937245, 1415.0681969948332)
('US', 587.1013599777646, -4997.018283670717)
('France', 110.68513563375512, 1387.0204496787837)
('Belgium', 70.80952847167056, 864.7564502670514)
('Korea, South', 4.39910181888815, 55.975676842764386)
('Brazil', 1077.1586295191412, -13442.77920138769)
('Iran', 70.13167263016915, -782.9699895205304)
('Netherlands', 63.2939151024787, 803.7344420719627)
('Canada', 27.98978371508961, 318.8405184469796)
('Turkey', 55.46054597709647, 701.7910198804145)
('Romania', 21.357796677843474, 270.8979164101942)
('Portugal', 15.175935667821602, 184.5804597856168)
('Sweden', 43.90736488492861, 546.0165883728265)
('Switzerland', 26.58299350590445, 333.96417178642895)
('Ireland', 13.129007145996102, 167.00701281271466)
('Hungary', 9.30239909299379, 120.41539807009731)
('Denmark', 6.62304065064477, 80.73607945760386)
('Austria', 9.420635463106407, 119.3146225238935)
('Mexico', 53.01476400894817, -722.5707103783716)
('India', 125.81088553225828, -298.57581060108896)
('Ecuador', 17.625584795292045, -221.7425444307978)
('Russia', 50.00844797771536, -578.2224881932102)
('Peru', 102.05780918643741, -1340.0044241585347)
('Indonesia', 39.40587896400103, -494.47516861362794)
('Poland', 2.5936372046387506, -23.387723618543248)
('Philippines', 17.74795379948986, 121.58784346604938)
('Japan', 2.0975668713113373, 8.801760211242044)
('Pakistan', 176.31122395852105, 2177.7514634136714)
running with seed 6
step    0 loss = nan
running with seed 7
step    0 loss = 507950
step  100 loss = 201089
step  200 loss = 139463
step  300 loss = 136164
step  400 loss = 115140
step  500 loss = 158554
step  600 loss = 82062
step  700 loss = 82071.6
step  800 loss = 64606.3
step  900 loss = 67761.3
step 1000 loss = 48991.5
step 1100 loss = 34304.2
step 1200 loss = 28543.1
step 1300 loss = 25619.8
step 1400 loss = 27834
step 1500 loss = 21008.4
step 1600 loss = 27363
step 1700 loss = 21691.3
step 1800 loss = 30973.4
step 1900 loss = 17417.1
('United Kingdom', 62.99327959923744, -701.7086483538515)
('Italy', 351.3898125924199, 4264.411018752887)
('Germany', 56.91361363558288, 708.8106720489749)
('Spain', 208.10017915210642, 2593.1381637695545)
('US', 520.5624801919876, 7076.270501678322)
('France', 58.739961585178506, 711.9277768467174)
('Belgium', 44.67662633279185, 547.3687942378522)
('Korea, South', 3.1993546298341817, 39.024606026222784)
('Brazil', 564.5443689843162, -7166.257613806203)
('Iran', 154.41128056983902, -1921.7245444021864)
('Netherlands', 71.44083812957217, 898.40526043629)
('Canada', 8.04873535392075, -106.92303182219592)
('Turkey', 47.75759254189852, 604.9239485921032)
('Romania', 3.4187472031676283, -42.49664819134074)
('Portugal', 15.037791879346447, 181.20599901026847)
('Sweden', 70.87211940045147, 853.4162238336518)
('Switzerland', 25.281754586720467, 313.3531700310612)
('Ireland', 16.15580000759579, 204.6853918761986)
('Hungary', 5.743088421794975, 74.43463066092319)
('Denmark', 8.418815067612886, 104.30536485972647)
('Austria', 9.718759355033969, 121.6124324910485)
('Mexico', 397.72550537346075, -4786.949393281335)
('India', 906.5999124627856, 11426.569050419394)
('Ecuador', 23.723903344836426, 293.54782695806625)
('Russia', 34.0886638893115, -387.72997062685)
('Peru', 48.22785527378146, -660.24639248522)
('Indonesia', 38.66244183086601, -472.19948416160344)
('Poland', 11.932235469668996, -153.2198379206847)
('Philippines', 15.621725830115277, 58.20436323235418)
('Japan', 7.102069140800471, 89.73827385469623)
('Pakistan', 155.57913444051133, 1959.115195547685)
running with seed 8
step    0 loss = 5.14542e+08
step  100 loss = 215288
step  200 loss = 93266.2
step  300 loss = 69093.4
step  400 loss = 50609.8
step  500 loss = 51289.6
step  600 loss = 28880.6
step  700 loss = 357628
step  800 loss = 63359.3
step  900 loss = 38772.4
step 1000 loss = 15162.7
step 1100 loss = 31228.9
step 1200 loss = 35524.3
step 1300 loss = 13659.9
step 1400 loss = 15549.5
step 1500 loss = 13370.1
step 1600 loss = 13074
step 1700 loss = 11530.5
step 1800 loss = 11255.5
step 1900 loss = 9658.58
('United Kingdom', 11.322805799239074, -28.903207501178258)
('Italy', 134.3916952124698, 1590.0030516914308)
('Germany', 67.13703200656762, 836.5197759387537)
('Spain', 119.03992021237784, 1472.8606648926548)
('US', 320.63238323834406, -1066.0494270694107)
('France', 243.62119590730853, 3047.4555352263587)
('Belgium', 63.121797362487776, 770.5421434649409)
('Korea, South', 4.280436938695107, 54.44721713378158)
('Brazil', 43.05191733499358, -318.40168477471525)
('Iran', 17.766737337220892, 174.28689955346817)
('Netherlands', 52.17866256498595, 650.0832205149944)
('Canada', 54.77866497193943, 675.8329398428507)
('Turkey', 62.07521745120965, 783.3104302200047)
('Romania', 6.198152618135351, 80.83111131792822)
('Portugal', 13.470807416638745, 163.81154769727462)
('Sweden', 57.160028785628555, 708.126236019296)
('Switzerland', 29.177314755413857, 363.76478692930067)
('Ireland', 13.019444229390714, 164.19142477953943)
('Hungary', 5.793336791586962, 73.02047679512039)
('Denmark', 8.824529149528988, 110.44408915107147)
('Austria', 12.082750136320323, 153.9538507416081)
('Mexico', 422.3437614207297, 5193.7052257749165)
('India', 166.66299270127877, 1382.2019058561455)
('Ecuador', 87.26927163736312, 1104.118586519779)
('Russia', 70.19723284370873, -820.5825818809694)
('Peru', 128.76016034363826, 1414.338322007614)
('Indonesia', 38.850099757302075, -482.5399384837732)
('Poland', 4.9801162166459045, -56.489913720767674)
('Philippines', 28.816026411885186, 351.72085732815054)
('Japan', 2.445677128417112, 19.083972603260367)
('Pakistan', 178.41292499536075, 2241.5013366544035)
running with seed 9
step    0 loss = 1.59997e+10
step  100 loss = 66604.5
step  200 loss = 58681
step  300 loss = 256249
step  400 loss = 44630.6
step  500 loss = 100573
step  600 loss = 27102.2
step  700 loss = 26128.4
step  800 loss = 20350.5
step  900 loss = 21486.9
step 1000 loss = 60943.7
step 1100 loss = 15456.3
step 1200 loss = 28008.2
step 1300 loss = 41462.5
step 1400 loss = 16409.3
step 1500 loss = 11359.7
step 1600 loss = 16315.6
step 1700 loss = 17327.6
step 1800 loss = 19447.5
step 1900 loss = 39710.4
('United Kingdom', 11.145391428184702, 132.45506982335064)
('Italy', 38.59425278810437, 400.0328276364859)
('Germany', 126.10031886554259, 1564.9373332268185)
('Spain', 130.43905537014587, 1602.62961503825)
('US', 798.2162151438674, 10945.382945917438)
('France', 115.7232008197633, 1459.6818213131673)
('Belgium', 95.68735810720244, 1186.9970277459481)
('Korea, South', 5.594111589017107, 68.90417251452021)
('Brazil', 1410.8215327037392, 16619.2747625974)
('Iran', 184.55191071217794, -2227.4867230437476)
('Netherlands', 25.89571638214454, 325.74146466912947)
('Canada', 174.02545709907074, 2138.5193731336635)
('Turkey', 44.23756776718277, 560.2671659745772)
('Romania', 3.1483232602445614, 40.81095147110426)
('Portugal', 6.550002095558512, 75.91868476478513)
('Sweden', 50.79416900228131, 613.0059304751613)
('Switzerland', 34.89760040393233, 436.173986361981)
('Ireland', 7.47983215219219, 94.43789377700632)
('Hungary', 7.151041683711268, 91.97677762306911)
('Denmark', 9.565662720347408, 118.34431495757849)
('Austria', 7.251037105226966, 90.76939511033079)
('Mexico', 2921.1880427752576, 35631.736846433516)
('India', 357.42864899009993, -4695.131630001841)
('Ecuador', 107.9917458928921, 1394.0882058680736)
('Russia', 99.79472736623705, -1168.940603285169)
('Peru', 1147.277756645885, 13742.31366155759)
('Indonesia', 34.8112174047327, -399.9602917395399)
('Poland', 0.853815704456122, 9.531148285487632)
('Philippines', 27.416338309584663, 338.95989577161396)
('Japan', 1.5814146562454239, 14.745276569927302)
('Pakistan', 1440.8947906283502, 17387.4992823834)
running with seed 10
step    0 loss = 4.71475e+07
step  100 loss = 280709
step  200 loss = 183946
step  300 loss = 180159
step  400 loss = 152257
step  500 loss = 150456
step  600 loss = 1.00612e+06
step  700 loss = 2.14918e+06
step  800 loss = 79135.6
step  900 loss = 104596
step 1000 loss = 1.226e+06
step 1100 loss = 61567.9
step 1200 loss = 52112
step 1300 loss = 57501.6
step 1400 loss = 70545.8
step 1500 loss = 127107
step 1600 loss = 49777.1
step 1700 loss = 38446.9
step 1800 loss = 100116
step 1900 loss = 40277.2
('United Kingdom', 158.3525464202195, -1889.9517771507126)
('Italy', 29.778303801280988, 253.803307712668)
('Germany', 103.75767719508274, 1276.39016840023)
('Spain', 74.53731453011072, 896.3858876147175)
('US', 1360.0294072711674, -14419.964998012423)
('France', 644.3459906582582, -8258.415302685631)
('Belgium', 138.3466692261574, 1719.1714470601985)
('Korea, South', 8.537329364052933, 109.71839240514731)
('Brazil', 1164.9990031583786, -14411.356316694248)
('Iran', 184.1699596199058, -2217.79775323754)
('Netherlands', 18.608228801217123, 226.34305361461423)
('Canada', 87.639917418158, -1132.4534938414329)
('Turkey', 41.08180158968909, 516.300539798299)
('Romania', 1.012147373234876, 10.920083439477082)
('Portugal', 9.596854292197357, 112.95486287016357)
('Sweden', 35.963883513797825, 437.6374443372166)
('Switzerland', 33.22047240148796, 416.0663735197308)
('Ireland', 8.044646600992273, 99.97313252294016)
('Hungary', 8.560684516707228, 110.40898308967702)
('Denmark', 8.461326415912502, 105.64440826783812)
('Austria', 8.42164432152983, 105.3313846868116)
('Mexico', 601.2460443760879, -7191.72617222862)
('India', 461.794057452536, 5505.274430781792)
('Ecuador', 27.01248771137038, 341.48072413700083)
('Russia', 48.12439377313074, -526.3422854108953)
('Peru', 60.92979009916628, -827.73930997344)
('Indonesia', 68.23122946850282, -852.9032126552837)
('Poland', 2.7189438932986736, -33.803011105647954)
('Philippines', 19.586478576519625, 208.65364679010264)
('Japan', 4.049884820458435, 47.69773640561512)
('Pakistan', 272.17041031010103, 3454.668117756839)
running with seed 11
step    0 loss = 2.40251e+07
